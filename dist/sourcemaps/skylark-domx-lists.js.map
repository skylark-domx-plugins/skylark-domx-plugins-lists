{"version":3,"sources":["skylark-domx-lists.js"],"names":["define","skylark","attach","langx","$","elmx","plugins","Collapse","lists","Listing","Plugin","inherit","klassName","pluginName","options","multiSelect","multitier","mode","levels","selectors","children","hasChildren","toggler","classes","collapsed","expanded","multiExpand","tree","expandIcon","collapseIcon","templates","treeIcon","itemGroup","accordion","popover","toggle","active","item","template","checkable","icon","text","selected","state","Object","_construct","elm","this","overrided","self","velm","_velm","_elm","itemSelector","_$items","on","veItem","hasClass","value","data","undefined","index","multitierMode","childrenSelector","togglerSelector","has","find","e","preventDefault","closest","siblings","removeClass","plugin","hide","toggleClass","filter","addClass","not","_refresh","updates","findItem","valueOrIdx","isNumber","eq","oldValue","selectOneItem","register","main"],"mappings":"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","file":"../skylark-domx-lists.js","sourcesContent":["define('skylark-domx-lists/lists',[\r\n\t\"skylark-langx/skylark\"\r\n],function(skylark){\r\n\treturn skylark.attach(\"domx.lists\",{});\r\n});\n define('skylark-domx-lists/Listing',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-velm\",\r\n  \"skylark-domx-plugins\",\r\n  \"skylark-domx-panels/Collapse\",\r\n  \"./lists\"\r\n],function(langx,$,elmx,plugins,Collapse,lists){\r\n\r\n    var Listing = plugins.Plugin.inherit({\r\n        klassName : \"Listing\",\r\n\r\n        pluginName : \"lark.listing\",\r\n\r\n        options : {\r\n        \tmultiSelect: false,\r\n        \t//multitier : false,\r\n\r\n          multitier : {\r\n            mode   : \"\",  // \"tree\" or \"accordion\" or \"popover\"\r\n            levels : 2,\r\n            selectors :  {\r\n              children : \"ul\",  // \"> .list-group\"\r\n              hasChildren : \":has(ul)\",\r\n              toggler : \" > a\"\r\n            },\r\n            classes : {\r\n              collapsed : \"\",\r\n              expanded : \"\"\r\n            },\r\n\r\n            multiExpand : true,\r\n\r\n            tree : {\r\n              classes : {\r\n                expandIcon: 'glyphicon-plus',    // \"glyphicon-chevron-down\", 'glyphicon-folder-open'\r\n                collapseIcon: 'glyphicon-minus', // \"glyphicon-chevron-right\", 'glyphicon-folder-close'\r\n                children : \"\"                              // \"list-group children\"\r\n              },\r\n              templates : {\r\n                treeIcon : \"<i class=\\\"glyphicon\\\"></i>\",\r\n                itemGroup: \"\"\r\n\r\n              },\r\n              selectors : {\r\n                treeIcon : \" > i\"\r\n              }\r\n            },\r\n\r\n            accordion : {\r\n              selectors : {\r\n                toggler : \" > a\"\r\n              }\r\n\r\n            },\r\n            popover : {\r\n              selectors : {\r\n                toggler : \" > a\"\r\n              }\r\n\r\n            }            \r\n          },\r\n\r\n        \ttoggle : false,\r\n        \tclasses : {\r\n          \tactive : \"active\"\r\n        \t},\r\n\r\n\r\n        \tselectors : {\r\n          \titem : \"li\",                   // \".list-group-item\"\r\n\r\n        \t},\r\n\r\n          item : {\r\n            template : \"<span><i class=\\\"glyphicon\\\"></i><a href=\\\"javascript: void(0);\\\"></a> </span>\",\r\n            checkable : false,\r\n            selectors : {\r\n              icon : \" > span > i\",\r\n              text : \" > span > a\"\r\n            }\r\n          },\r\n\r\n        \tselected : 0\r\n        },\r\n\r\n        state : {\r\n          selected : Object\r\n        },\r\n\r\n        _construct : function(elm,options) {\r\n            this.overrided(elm,options);\r\n            var self = this,\r\n                velm = this._velm = elmx(this._elm),\r\n                itemSelector = this.options.selectors.item;\r\n\r\n            this._$items = velm.$(itemSelector);\r\n\r\n            velm.on('click', itemSelector, function () {\r\n                var veItem = elmx(this);\r\n\r\n                if (!veItem.hasClass('disabled')) {\r\n                  var value = veItem.data(\"value\");\r\n                  if (value === undefined) {\r\n                    value = self._$items.index(this);\r\n                  }\r\n                  self.selected = value;\r\n                }\r\n\r\n                //veItem.blur();\r\n                return false;\r\n            });\r\n            this.selected = this.options.selected;\r\n\r\n            var $this = velm,\r\n                multitierMode = this.options.multitier.mode,\r\n                hasChildrenSelector = this.options.multitier.selectors.hasChildren,\r\n                childrenSelector = this.options.multitier.selectors.children,\r\n                iconSelector = this.options.item.selectors.icon,\r\n                textSelector = this.options.item.selectors.text,\r\n                itemTemplate = this.options.item.template,                \r\n                obj = this;\r\n\r\n\r\n            if (multitierMode) {\r\n            /*\r\n              if (multitierMode == \"tree\") {\r\n                   var treeIconTemplate = this.options.multitier.tree.templates.treeIcon,\r\n                       treeIconSelector = this.options.multitier.tree.selectors.treeIcon,\r\n                       expandIconClass = this.options.multitier.tree.classes.expandIcon,\r\n                       collapseIconClass = this.options.multitier.tree.classes.collapseIcon;\r\n\r\n                   this._$items.each(function(){\r\n                     if($(this).is(hasChildrenSelector)) {\r\n                        var children = $(this).find(childrenSelector);\r\n                        $(children).remove();\r\n                        text = $(this).text().trim();\r\n                        $(this).html(treeIconTemplate+itemTemplate);\r\n                        $(this).find(treeIconSelector).addClass(expandIconClass).on(\"click\" + \".\" + self.pluginName, function(e) {\r\n                            e.preventDefault();\r\n\r\n                            $(this).toggleClass(expandIconClass).toggleClass(collapseIconClass);\r\n\r\n                            $(this).closest(\"li\").toggleClass(\"active\").children(\"ul\").collapse(\"toggle\");\r\n\r\n                            if ($toggle) {\r\n                                $(this).closest(\"li\").siblings().removeClass(\"active\").children(\"ul.in\").collapse(\"hide\");\r\n                            }\r\n                        });\r\n\r\n                        $(this).find(iconSelector).addClass('glyphicon-folder-open');\r\n                        $(this).find(textSelector).text(text);\r\n                        $(this).append(children);\r\n\r\n\r\n\r\n                      }  else {\r\n                        text = $(this).text().trim();\r\n                        $(this).html(treeIconTemplate+itemTemplate);\r\n                        $(this).find(iconSelector).addClass('glyphicon-file');\r\n                        $(this).find(textSelector).text(text);\r\n                    }\r\n\r\n                   });\r\n              } else if (multitierMode == \"accordion\" || multitierMode==\"popover\"  ) {\r\n                var togglerSelector = self.options.multitier.accordion.selectors.toggler;\r\n\r\n                this._$items.has(childrenSelector).find(togglerSelector).on(\"click\" + \".\" + this.pluginName, function(e) {\r\n                    e.preventDefault();\r\n\r\n                    $(this).closest(itemSelector).toggleClass(\"active\").children(childrenSelector).collapse(\"toggle\");\r\n\r\n                    if ($toggle) {\r\n                        $(this).closest(itemSelector).siblings().removeClass(\"active\").children(childrenSelector+\".in\").collapse(\"hide\");\r\n                    }\r\n                });\r\n              }\r\n              */ \r\n              var multiExpand = self.options.multitier.multiExpand,\r\n                  togglerSelector = self.options.multitier.selectors.toggler;\r\n\r\n              this._$items.has(childrenSelector).find(togglerSelector).on(\"click\" + \".\" + this.pluginName, function(e) {\r\n                  e.preventDefault();\r\n\r\n                  if (multiExpand) {\r\n                      $(this).closest(itemSelector).siblings().removeClass(\"active\").children(childrenSelector+\".in\").plugin(\"domx.collapse\").hide();\r\n                  }\r\n                  $(this).closest(itemSelector).toggleClass(\"active\").children(childrenSelector).plugin(\"domx.collapse\").toggle();\r\n              });\r\n\r\n             this._$items.filter(\".active\").has(childrenSelector).children(childrenSelector).addClass(\"collapse in\");\r\n             this._$items.not(\".active\").has(childrenSelector).children(childrenSelector).addClass(\"collapse\");\r\n              \r\n            }   \r\n        },\r\n\r\n        _refresh : function(updates) {\r\n          this.overrided(updates);\r\n          var self  = this;\r\n\r\n          function findItem(valueOrIdx) {\r\n            var $item;\r\n            if (langx.isNumber(valueOrIdx)) {\r\n              $item = self._$items.eq(valueOrIdx);\r\n            } else {\r\n              $item = self._$items.filter('[data-value=\"' + valueOrIdx + '\"]');\r\n            }\r\n            return $item;\r\n          } \r\n                 \r\n          function selectOneItem(valueOrIdx) {\r\n            findItem(valueOrIdx).addClass(self.options.classes.active);\r\n          }\r\n\r\n          function unselectOneItem(valueOrIdx) {\r\n            findItem(valueOrIdx).removeClass(self.options.classes.active);\r\n          }\r\n\r\n          if (updates[\"selected\"]) {\r\n            if (this.options.multiSelect) {\r\n            } else {\r\n              unselectOneItem(updates[\"selected\"].oldValue);\r\n              selectOneItem(updates[\"selected\"].value);\r\n            }\r\n\r\n          }\r\n        }\r\n\r\n  });\r\n\r\n\r\n  plugins.register(Listing,\"lark.listing\");\r\n\r\n  return lists.Listing = Listing;\r\n\r\n});\r\n\r\n\r\n\r\n\ndefine('skylark-domx-lists/main',[\r\n    \"./lists\",\r\n    \"./Listing\"\r\n], function(lists) {\r\n    return lists;\r\n});\ndefine('skylark-domx-lists', ['skylark-domx-lists/main'], function (main) { return main; });\n\n"]}